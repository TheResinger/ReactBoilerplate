(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{20:function(e,t,n){e.exports=n(30)},30:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(18),l=n.n(o),s=n(6),c=n(1),u=function(e){return fetch("/user/login",{method:"post",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}}).then((function(e){return 401!==e.status?e.json().then((function(e){return e})):{isAuthenticated:!1,user:{username:"",role:""}}}))},m=function(e){return fetch("/user/register",{method:"post",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){return e}))},i=function(){return fetch("/user/logout").then((function(e){return e.json()})).then((function(e){return e}))},b=function(){return fetch("/user/authenticated").then((function(e){return 401!==e.status?e.json().then((function(e){return e})):{isAuthenticated:!1,user:{username:"",role:""}}}))},d=n(3),f=Object(a.createContext)(),E=function(e){var t=e.children,n=Object(a.useState)(null),o=Object(d.a)(n,2),l=o[0],s=o[1],c=Object(a.useState)(!1),u=Object(d.a)(c,2),m=u[0],i=u[1],E=Object(a.useState)(!1),h=Object(d.a)(E,2),p=h[0],g=h[1];return Object(a.useEffect)((function(){b().then((function(e){s(e.user),i(e.isAuthenticated),g(!0)}))}),[]),r.a.createElement("div",null,p?r.a.createElement(f.Provider,{value:{user:l,setUser:s,isAuthenticated:m,setIsAuthenticated:i}},t):r.a.createElement("h1",null,"Loading"))},h=function(e){var t=Object(a.useContext)(f),n=t.isAuthenticated,o=t.user,l=t.setIsAuthenticated,c=t.setUser,u=function(){i().then((function(e){e.success&&(c(e.user),l(!1))}))};return r.a.createElement("nav",{className:"navbar navbar-expand-lg navbar-light bg-light"},r.a.createElement(s.b,{to:"/"},r.a.createElement("div",{className:"navbar-brand"},"Resinger")),r.a.createElement("div",{className:"collapse navbar-collapse",id:"navbarText"},r.a.createElement("ul",{className:"navbar-nav mr-auto"},n?r.a.createElement(r.a.Fragment,null,r.a.createElement(s.b,{to:"/"},r.a.createElement("li",{className:"nav-item nav-link"}," Home ")),r.a.createElement(s.b,{to:"/todos"},r.a.createElement("li",{className:"nav-item nav-link"}," Todos ")),"admin"===o.role?r.a.createElement(s.b,{to:"/admin"},r.a.createElement("li",{className:"nav-item nav-link"}," Admin ")):null,r.a.createElement("button",{type:"button",className:"btn btn-link nav-item nav-link",onClick:u}," Logout ")):r.a.createElement(r.a.Fragment,null,r.a.createElement(s.b,{to:"/"},r.a.createElement("li",{className:"nav-item nav-link"}," Home ")),r.a.createElement(s.b,{to:"/login"},r.a.createElement("li",{className:"nav-item nav-link"}," Login ")),r.a.createElement(s.b,{to:"/register"},r.a.createElement("li",{className:"nav-item nav-link"}," Register "))))))},p=function(){return r.a.createElement("h1",null,"Home Page")},g=n(9),v=n(10),j=function(e){var t="alert ";return e.message.msgError?t+="alert-danger":t+="alert-primary",t+" text-center"},O=function(e){return r.a.createElement("div",{className:j(e),role:"alert"},e.message.msgBody)},y=function(e){var t=Object(a.useState)({username:"",password:""}),n=Object(d.a)(t,2),o=n[0],l=n[1],s=Object(a.useState)(null),c=Object(d.a)(s,2),m=c[0],i=c[1],b=Object(a.useContext)(f),E=function(e){l(Object(v.a)(Object(v.a)({},o),{},Object(g.a)({},e.target.name,e.target.value)))};return r.a.createElement("div",null,r.a.createElement("form",{onSubmit:function(t){t.preventDefault(),u(o).then((function(t){var n=t.isAuthenticated,a=t.user,r=t.message;n?(b.setUser(a),b.setIsAuthenticated(n),e.history.push("/todos")):i(r)}))}},r.a.createElement("h3",null,"Please Sign In"),r.a.createElement("label",{htmlFor:"username",className:"sr-only"},"Username:"," "),r.a.createElement("input",{type:"text",name:"username",onChange:E,className:"form-control",placeholder:"Enter Username"}),r.a.createElement("label",{htmlFor:"password",className:"sr-only"},"Password:"," "),r.a.createElement("input",{type:"password",name:"password",onChange:E,className:"form-control",placeholder:"Enter Password"}),r.a.createElement("button",{className:"btn btn-large btn-primary btn-block",type:"submit"},"Log In")),m?r.a.createElement(O,{message:m}):null)},N=function(e){var t=Object(a.useState)({username:"",password:"",role:"user"}),n=Object(d.a)(t,2),o=n[0],l=n[1],s=Object(a.useState)(null),c=Object(d.a)(s,2),u=c[0],i=c[1],b=Object(a.useRef)(null);Object(a.useEffect)((function(){return function(){clearTimeout(b)}}),[]);var f=function(e){l(Object(v.a)(Object(v.a)({},o),{},Object(g.a)({},e.target.name,e.target.value)))};return r.a.createElement("div",null,r.a.createElement("form",{onSubmit:function(t){t.preventDefault(),m(o).then((function(t){var n=t.message;i(n),l({username:"",password:"",role:""}),n.msgError||(b=setTimeout((function(){e.history.push("/login")}),2e3))}))}},r.a.createElement("h3",null,"Please Register"),r.a.createElement("label",{htmlFor:"username",className:"sr-only"},"Username: "),r.a.createElement("input",{type:"text",name:"username",onChange:f,className:"form-control",placeholder:"Enter Username",value:o.username}),r.a.createElement("label",{htmlFor:"password",className:"sr-only"},"Password: "),r.a.createElement("input",{type:"password",name:"password",onChange:f,className:"form-control",placeholder:"Enter Password",value:o.password}),r.a.createElement("button",{className:"btn btn-large btn-primary btn-block",type:"submit"},"Register")),u?r.a.createElement(O,{message:u}):null)},S=function(e){return r.a.createElement("li",null,e.todo.name," ")},w=function(){return fetch("/user/todos").then((function(e){return 401!==e.status?e.json().then((function(e){return e})):{message:{msgBody:"Unauthorized"},msgError:!0}}))},k=function(e){return fetch("/user/todo",{method:"post",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}}).then((function(e){return 401!==e.status?e.json().then((function(e){return e})):{message:{msgBody:"Unauthorized"},msgError:!0}}))},C=function(e){var t=Object(a.useState)({name:""}),n=Object(d.a)(t,2),o=n[0],l=n[1],s=Object(a.useState)([]),c=Object(d.a)(s,2),u=c[0],m=c[1],i=Object(a.useState)(null),b=Object(d.a)(i,2),E=b[0],h=b[1],p=Object(a.useContext)(f);Object(a.useEffect)((function(){w().then((function(e){m(e.todos)}))}),[]);var g=function(){l({name:""})};return r.a.createElement("div",null,r.a.createElement("ul",{className:"list-group"},u.map((function(e){return r.a.createElement(S,{key:e._id,todo:e})}))),r.a.createElement("br",null),r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),k(o).then((function(e){var t=e.message;g(),t.msgError?"Unauthorized"===t.msgBody?(h(t),p.setUser({username:"",role:""}),p.setIsAuthenticated(!1)):h(t):w().then((function(e){m(e.todos),h(t)}))}))}},r.a.createElement("label",{htmlFor:"Todo"},"Enter Todo"),r.a.createElement("input",{type:"text",name:"todo",value:o.name,onChange:function(e){l({name:e.target.value})},className:"form-control",placeholder:"Please Enter Todo"}),r.a.createElement("button",{className:"btn btn-lg btn-primary btn-block",type:"submit"},"Submit")),E?r.a.createElement(O,{message:E}):null)},x=function(){return r.a.createElement("h1",null,"Admin Page")},A=n(12),U=function(e){var t=e.component,n=e.roles,o=Object(A.a)(e,["component","roles"]),l=Object(a.useContext)(f),s=l.isAuthenticated,u=l.user;return r.a.createElement(c.b,Object.assign({},o,{render:function(e){return s?n.includes(u.role)?r.a.createElement(t,e):r.a.createElement(c.a,{to:{pathname:"/",state:{from:e.location}}}):r.a.createElement(c.a,{to:{pathname:"/login",state:{from:e.location}}})}}))},P=function(e){var t=e.component,n=Object(A.a)(e,["component"]),o=Object(a.useContext)(f).isAuthenticated;return r.a.createElement(c.b,Object.assign({},n,{render:function(e){return o?r.a.createElement(c.a,{to:{pathname:"/",state:{from:e.location}}}):r.a.createElement(t,e)}}))};var T=function(){return r.a.createElement(s.a,null,r.a.createElement(h,null),r.a.createElement(c.b,{exact:!0,path:"/",component:p}),r.a.createElement(P,{path:"/login",component:y}),r.a.createElement(P,{path:"/register",component:N}),r.a.createElement(U,{path:"/todos",roles:["user","admin"],component:C}),r.a.createElement(U,{path:"/admin",roles:["admin"],component:x}))};l.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(E,null,r.a.createElement(T,null))),document.getElementById("root"))}},[[20,1,2]]]);
//# sourceMappingURL=main.dd729604.chunk.js.map